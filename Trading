import requests, time
import pandas as pd
from datetime import datetime


def datetotimestamp(date):
    time_tuple = date.timetuple()
    timestamp=round(time.mktime(time_tuple))
    return timestamp

date = datetime.today()
print(datetotimestamp(date))

def datetotimestamp(date):
  time_tuple = date.timetuple()
  timestamp = round(time.mktime(time_tuple))
  return timestamp

def timestamptodate(timestamp):
  return datetime.fromtimestamp(timestamp)

start = datetotimestamp(datetime(2022,11,11))
end= datetotimestamp(datetime.today())
url = 'https://priceapi.moneycontrol.com/techCharts/history?symbol=23&resolution=5&from='+str(start)+'&to='+str(end)+''
print(url)

resp = requests.get(url).json()
data = pd.DataFrame(resp)
date = []
for dt in data['t']:
  date.append({'Date':timestamptodate(dt)})

dt = pd.DataFrame(date)
print(dt)


intraday_data = pd.concat([dt,data['o'],data['h'],data['l'],data['c'], data['v']],axis=1)\
    .rename(columns={'o':'Open','h':'High','l':'Low','c':'Close','v':'Volume'})
print(intraday_data)
